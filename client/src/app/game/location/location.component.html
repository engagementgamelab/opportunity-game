<div class="location {{currentLocation?.image}}">
	
	<div id="back" (click)="backToCategory()" class="btn">
		<cdn-image cloudinaryId="opportunity-game/icons/back.svg" width="50" alt="Back to Category"></cdn-image>
	</div>

	 	<div id="list" class="col-6">
			<button *ngFor="let opportunity of currentLocation?.opportunities" (click)="viewOpportunity(opportunity._id, opportunity.enabled)" class="col-6 bold" 
				[class.unlocked]="opportunity.enabled === undefined" id="listing_{{opportunity._id}}">

				<div class="name">
					{{opportunity.name}}
				</div>

				<!-- Rewards -->
				<div class="reward">
					<div class="icon">
						<cdn-image cloudinaryId="opportunity-game/icons/{{opportunity.reward.icon}}.svg" width="75" alt="Icon for Reward" *ngIf="opportunity.enabled === undefined"></cdn-image>
						<cdn-image cloudinaryId="opportunity-game/icons/{{opportunity.reward.icon}}-used.svg" width="75" alt="Icon for Reward" *ngIf="opportunity.enabled === false"></cdn-image>
					</div>

					<div class="badge" *ngFor="let badge of opportunity.reward.badges">
						<cdn-image cloudinaryId="opportunity-game/icons/{{badge}}.svg" width="25" alt="Icon for Badge"></cdn-image>
					</div>

				</div>

				<!-- Requires: {{opportunity.type}} -->
				<div class="costs row col-6" *ngIf="opportunity.enabled === undefined">
					<div class="{{cost.icon}} cost col-1" [class.notenough]="cost.has !== undefined && !cost.has" *ngFor="let cost of opportunity.costs">
						<span *ngIf="cost.amt !== undefined">{{cost.amt}}</span>
					</div>
					<div class="{{cost.icon}} cost col-1" [class.notenough]="cost.has !== undefined && !cost.has" *ngFor="let cost of opportunity.reqs">
						<span *ngIf="cost.amt !== undefined">{{cost.amt}}</span>
					</div>
				</div>
				<div class="costs used row col-6" *ngIf="opportunity.enabled === false">
					<div>You have already used this opportunity.</div>
				</div>

			</button>
		</div>

		<div id="details" class="modal hidden">
			<div *ngFor="let opportunity of currentLocation?.opportunities" class="opportunity col-5 col-centered vert-center medium hidden" id="detail_{{opportunity._id}}">
					<div>
						<span class="bold">{{opportunity.description.html | removeTags}}</span>
					</div>
					<div class="row reward-bg">
						<!-- Reward -->
						<div class="reward col-2 col-centered no-pad">
							<div class="badge" *ngIf="opportunity.triggerAmt > 0">
								<cdn-image cloudinaryId="opportunity-game/icons/gold_clock.svg" width="25" alt="Icon for Delay"></cdn-image>
							</div>
							<div class="icon">
								<cdn-image cloudinaryId="opportunity-game/icons/{{opportunity.reward.icon}}.svg" alt="Icon for Reward"></cdn-image>
							</div>

						</div>
						
					</div>
					<div class="delay bold" *ngIf="opportunity.triggerAmt > 0">
						This takes {{opportunity.triggerAmt}} Actions to complete
					</div>

					<div class="footer">
							<!-- costs -->
							<div class="costs auto" *ngIf="opportunity.costs.length > 0">
								<div class="bold medium" *ngIf="opportunity.costs.length > 0">COST</div> 
								<div class="auto" *ngIf="opportunity.enabled === undefined">
									<div *ngFor="let cost of opportunity.costs" class="cost {{cost.icon}} auto">
										<div *ngIf="cost.amt !== undefined && cost.isLvl === undefined" class="text bold">{{cost.amt}}</div>
									</div>
								</div>
							</div>

							<!-- requirements -->
							<div class="reqs auto">
								<div class="bold medium" *ngIf="opportunity.reqs.length > 0">REQUIRED</div> 
								<div class="auto" *ngIf="opportunity.enabled === undefined">
									<div *ngFor="let cost of opportunity.reqs" class="cost {{cost.icon}} auto">
										<div *ngIf="cost.isLvl === true" class="badge bold">{{cost.amt}}</div>
									</div>
								</div>
							</div>
							
							<span class="bold" *ngIf="opportunity.costs.length < 1">This opportunity is free!</span>
							<span class="bold" *ngIf="opportunity.locked === true"><br/>You don't have the requirements to learn more!</span>
					</div>

					<div class="row buttons" *ngIf="opportunity.locked === false">
						<app-button label="Yes" ariaLabel="Click to learn about {{opportunity.name}}" clickData="true" (clickEvent)="selectOpportunity(opportunity, opportunity._id)" class="green col-centered"></app-button>
						<app-button label="No" ariaLabel="Click to close {{opportunity.name}} window" clickData="true" (clickEvent)="backToList(opportunity._id)" class="orange col-centered"></app-button>
					</div>
					<div class="row buttons" *ngIf="opportunity.locked === true">
						<app-button label="Close" ariaLabel="Click to close {{opportunity.name}} window" clickData="true" (clickEvent)="backToList(opportunity._id)" class="orange col-centered"></app-button>
					</div>

			</div>
		</div>

</div>